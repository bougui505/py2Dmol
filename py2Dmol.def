Bootstrap: docker
From: python:3-slim

%post
    # Install system dependencies
    apt-get update && apt-get install -y \
        git \
        wget \
        && rm -rf /var/lib/apt/lists/*

    # Install py2Dmol from GitHub
    cd /opt
    git clone https://github.com/bougui505/py2Dmol.git
    cd py2Dmol
    pip install -e .
    pip install notebook

    # Create py2Dmol.ipynb with required imports
    cd /opt/py2Dmol
    echo '{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import py2Dmol",
    "from py2Dmol.viewer import view",
    "print(\"py2Dmol imported successfully!\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "name": "python",
   "version": "3.9.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}' > py2Dmol.ipynb

%environment
    export PYTHONPATH="/opt/py2Dmol:$PYTHONPATH"

%runscript
    cp -v /opt/py2Dmol/py2Dmol.ipynb .
    exec python3 -m notebook --ip=0.0.0.0 --port=8888 --no-browser --allow-root py2Dmol.ipynb
